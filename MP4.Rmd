---
title: "MP4"
author: Natalia Iannucci and Hana Hirano
output: 
  html_document:
    code_folding: hide
---
```{r}
library(tidyverse)
library(RMySQL)
library(DBI)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "citibike")
knitr::opts_chunk$set(connection = db, max.print = 20)
```

```{r}
age_gender <- dbGetQuery(
"SELECT gender, (t.duration / 60) AS duration_in_min, (2019 - t.birth_year) AS age
FROM trips AS t
HAVING age < 100
AND gender <> 0 
ORDER BY gender, age"
)

age_gender
```

To find which start station id to use:
```{sql connection=db}
SELECT start_station_id, count(*) AS n
FROM citibike.trips
GROUP BY start_station_id
ORDER BY n DESC;
```


Will give the distances for the most popular start station (I sorted just that data in descedning order to find the right one) from greatest to least distance, and then shows the age, and all only for women
```{sql connection=db}
SELECT gender, (t.duration / 60) AS duration_in_min, (2019 - t.birth_year) AS age
FROM trips AS t
LEFT JOIN station_months 
	ON station_months.station_id = t.start_station_id
WHERE station_id = 519
	AND gender = 2
GROUP BY duration_in_min
HAVING age < 100
AND gender <> 0 
ORDER BY duration_in_min DESC;
```


this is the same thing for men so we could compare the two
```{sql connection=db}
SELECT gender, (t.duration / 60) AS duration_in_min, (2019 - t.birth_year) AS age
FROM trips AS t
LEFT JOIN station_months 
	ON station_months.station_id = t.start_station_id
WHERE station_id = 519
	AND gender = 1
GROUP BY duration_in_min
HAVING age < 100
AND gender <> 0 
ORDER BY duration_in_min, age;
```


